/*
 * File combining 
 * (1) sha.js by Brian Turek 2008-2013 under BSD license
 * (2) and a modified js OTP implementation found on JSFiddle
*/
(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f){if(this.expiry=null!=e?e:30,this.length=null!=f?f:6,this.timer=b(this.timer,this),this.length>8||this.length<6)throw"Error: invalid code length";this.accounts=[],this.add(a,c,d),setInterval(this.timer,1e3)}return a.prototype.dec2hex=function(a){return(15.5>a?"0":"")+Math.round(a).toString(16)},a.prototype.hex2dec=function(a){return parseInt(a,16)},a.prototype.base32tohex=function(a){var b,c,d,e,f,g;for(b="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",c="",e="",f=0;f<a.length;)g=b.indexOf(a.charAt(f).toUpperCase()),c+=this.leftpad(g.toString(2),5,"0"),f++;for(f=0;f+4<=c.length;)d=c.substr(f,4),e+=parseInt(d,2).toString(16),f+=4;return e},a.prototype.leftpad=function(a,b,c){return b+1>=a.length&&(a=Array(b+1-a.length).join(c)+a),a},a.prototype.getOtp=function(a){var b,c,d,e,f,g,h;if(e=this.base32tohex(a),b=Math.round((new Date).getTime()/1e3),h=this.leftpad(this.dec2hex(Math.floor(b/this.expiry)),16,"0"),d=new jsSHA(h,"HEX"),c=d.getHMAC(e,"HEX","SHA-1","HEX"),"KEY MUST BE IN BYTE INCREMENTS"===c)throw"Error: hex key must be in byte increments";return f=this.hex2dec(c.substring(c.length-1)),g=(this.hex2dec(c.substr(2*f,8))&this.hex2dec("7fffffff"))+"",g=g.substr(g.length-this.length,this.length)},a.prototype.updateOtp=function(){var a,b,c,d,e;for(d=this.accounts,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.codeEl.innerHTML=this.getOtp(a.secret));return e},a.prototype.timer=function(){var a,b,c,d,e,f;for(c=Math.round((new Date).getTime()/1e3),b=this.expiry-c%this.expiry,c%this.expiry===0&&this.updateOtp(),f=this.accounts,d=0,e=f.length;e>d;d++)a=f[d],a.tickEl.innerHTML=b},a.prototype.add=function(a,b,c){return this.accounts.push({secret:a,codeEl:b,tickEl:c}),this.updateOtp()},a}(),window.TotpManager=a}).call(this),function(a){function b(a,b,c){var j=0,k=[0],l="",m=null,l=c||"UTF8";if("UTF8"!==l&&"UTF16"!==l)throw"encoding must be UTF8 or UTF16";if("HEX"===b){if(0!==a.length%2)throw"srcString of HEX type must be in byte increments";m=e(a),j=m.binLen,k=m.value}else if("ASCII"===b||"TEXT"===b)m=d(a,l),j=m.binLen,k=m.value;else{if("B64"!==b)throw"inputFormat must be HEX, TEXT, ASCII, or B64";m=f(a),j=m.binLen,k=m.value}this.getHash=function(a,b,c,d){var e,f=null,l=k.slice(),m=j;if(3===arguments.length?"number"!=typeof c&&(d=c,c=1):2===arguments.length&&(c=1),c!==parseInt(c,10)||1>c)throw"numRounds must a integer >= 1";switch(b){case"HEX":f=g;break;case"B64":f=h;break;default:throw"format must be HEX or B64"}if("SHA-1"===a)for(e=0;c>e;e++)l=G(l,m),m=160;else if("SHA-224"===a)for(e=0;c>e;e++)l=H(l,m,a),m=224;else if("SHA-256"===a)for(e=0;c>e;e++)l=H(l,m,a),m=256;else if("SHA-384"===a)for(e=0;c>e;e++)l=H(l,m,a),m=384;else{if("SHA-512"!==a)throw"Chosen SHA variant is not supported";for(e=0;c>e;e++)l=H(l,m,a),m=512}return f(l,i(d))},this.getHMAC=function(a,b,c,m,n){var o,p,q,r,s=[],t=[];switch(o=null,m){case"HEX":m=g;break;case"B64":m=h;break;default:throw"outputFormat must be HEX or B64"}if("SHA-1"===c)p=64,r=160;else if("SHA-224"===c)p=64,r=224;else if("SHA-256"===c)p=64,r=256;else if("SHA-384"===c)p=128,r=384;else{if("SHA-512"!==c)throw"Chosen SHA variant is not supported";p=128,r=512}if("HEX"===b)o=e(a),q=o.binLen,o=o.value;else if("ASCII"===b||"TEXT"===b)o=d(a,l),q=o.binLen,o=o.value;else{if("B64"!==b)throw"inputFormat must be HEX, TEXT, ASCII, or B64";o=f(a),q=o.binLen,o=o.value}for(a=8*p,b=p/4-1,q/8>p?(o="SHA-1"===c?G(o,q):H(o,q,c),o[b]&=4294967040):p>q/8&&(o[b]&=4294967040),p=0;b>=p;p+=1)s[p]=909522486^o[p],t[p]=1549556828^o[p];return c="SHA-1"===c?G(t.concat(G(s.concat(k),a+j)),a+r):H(t.concat(H(s.concat(k),a+j,c)),a+r,c),m(c,i(n))}}function c(a,b){this.a=a,this.b=b}function d(a,b){var c,d,e=[],f=[],g=0;if("UTF8"===b)for(d=0;d<a.length;d+=1)for(c=a.charCodeAt(d),f=[],c>2048?(f[0]=224|(61440&c)>>>12,f[1]=128|(4032&c)>>>6,f[2]=128|63&c):c>128?(f[0]=192|(1984&c)>>>6,f[1]=128|63&c):f[0]=c,c=0;c<f.length;c+=1)e[g>>>2]|=f[c]<<24-g%4*8,g+=1;else if("UTF16"===b)for(d=0;d<a.length;d+=1)e[g>>>2]|=a.charCodeAt(d)<<16-g%4*8,g+=2;return{value:e,binLen:8*g}}function e(a){var b,c,d=[],e=a.length;if(0!==e%2)throw"String of HEX type must be in byte increments";for(b=0;e>b;b+=2){if(c=parseInt(a.substr(b,2),16),isNaN(c))throw"String of HEX type contains invalid characters";d[b>>>3]|=c<<24-b%8*4}return{value:d,binLen:4*e}}function f(a){var b,c,d,e,f,g=[],h=0;if(-1===a.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(b=a.indexOf("="),a=a.replace(/\=/g,""),-1!==b&&b<a.length)throw"Invalid '=' found in base-64 string";for(c=0;c<a.length;c+=4){for(f=a.substr(c,4),d=e=0;d<f.length;d+=1)b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[d]),e|=b<<18-6*d;for(d=0;d<f.length-1;d+=1)g[h>>2]|=(e>>>16-8*d&255)<<24-h%4*8,h+=1}return{value:g,binLen:8*h}}function g(a,b){var c,d,e="",f=4*a.length;for(c=0;f>c;c+=1)d=a[c>>>2]>>>8*(3-c%4),e+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(15&d);return b.outputUpper?e.toUpperCase():e}function h(a,b){var c,d,e,f="",g=4*a.length;for(c=0;g>c;c+=3)for(e=(a[c>>>2]>>>8*(3-c%4)&255)<<16|(a[c+1>>>2]>>>8*(3-(c+1)%4)&255)<<8|a[c+2>>>2]>>>8*(3-(c+2)%4)&255,d=0;4>d;d+=1)f=8*c+6*d<=32*a.length?f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-d)&63):f+b.b64Pad;return f}function i(a){var b={outputUpper:!1,b64Pad:"="};try{a.hasOwnProperty("outputUpper")&&(b.outputUpper=a.outputUpper),a.hasOwnProperty("b64Pad")&&(b.b64Pad=a.b64Pad)}catch(c){}if("boolean"!=typeof b.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof b.b64Pad)throw"Invalid b64Pad formatting option";return b}function j(a,b){return a<<b|a>>>32-b}function k(a,b){return a>>>b|a<<32-b}function l(a,b){var d=null,d=new c(a.a,a.b);return d=32>=b?new c(d.a>>>b|d.b<<32-b&4294967295,d.b>>>b|d.a<<32-b&4294967295):new c(d.b>>>b-32|d.a<<64-b&4294967295,d.a>>>b-32|d.b<<64-b&4294967295)}function m(a,b){var d=null;return d=32>=b?new c(a.a>>>b,a.b>>>b|a.a<<32-b&4294967295):new c(0,a.a>>>b-32)}function n(a,b,c){return a^b^c}function o(a,b,c){return a&b^~a&c}function p(a,b,d){return new c(a.a&b.a^~a.a&d.a,a.b&b.b^~a.b&d.b)}function q(a,b,c){return a&b^a&c^b&c}function r(a,b,d){return new c(a.a&b.a^a.a&d.a^b.a&d.a,a.b&b.b^a.b&d.b^b.b&d.b)}function s(a){return k(a,2)^k(a,13)^k(a,22)}function t(a){var b=l(a,28),d=l(a,34);return a=l(a,39),new c(b.a^d.a^a.a,b.b^d.b^a.b)}function u(a){return k(a,6)^k(a,11)^k(a,25)}function v(a){var b=l(a,14),d=l(a,18);return a=l(a,41),new c(b.a^d.a^a.a,b.b^d.b^a.b)}function w(a){return k(a,7)^k(a,18)^a>>>3}function x(a){var b=l(a,1),d=l(a,8);return a=m(a,7),new c(b.a^d.a^a.a,b.b^d.b^a.b)}function y(a){return k(a,17)^k(a,19)^a>>>10}function z(a){var b=l(a,19),d=l(a,61);return a=m(a,6),new c(b.a^d.a^a.a,b.b^d.b^a.b)}function A(a,b){var c=(65535&a)+(65535&b);return((a>>>16)+(b>>>16)+(c>>>16)&65535)<<16|65535&c}function B(a,b,c,d){var e=(65535&a)+(65535&b)+(65535&c)+(65535&d);return((a>>>16)+(b>>>16)+(c>>>16)+(d>>>16)+(e>>>16)&65535)<<16|65535&e}function C(a,b,c,d,e){var f=(65535&a)+(65535&b)+(65535&c)+(65535&d)+(65535&e);return((a>>>16)+(b>>>16)+(c>>>16)+(d>>>16)+(e>>>16)+(f>>>16)&65535)<<16|65535&f}function D(a,b){var d,e,f;return d=(65535&a.b)+(65535&b.b),e=(a.b>>>16)+(b.b>>>16)+(d>>>16),f=(65535&e)<<16|65535&d,d=(65535&a.a)+(65535&b.a)+(e>>>16),e=(a.a>>>16)+(b.a>>>16)+(d>>>16),new c((65535&e)<<16|65535&d,f)}function E(a,b,d,e){var f,g,h;return f=(65535&a.b)+(65535&b.b)+(65535&d.b)+(65535&e.b),g=(a.b>>>16)+(b.b>>>16)+(d.b>>>16)+(e.b>>>16)+(f>>>16),h=(65535&g)<<16|65535&f,f=(65535&a.a)+(65535&b.a)+(65535&d.a)+(65535&e.a)+(g>>>16),g=(a.a>>>16)+(b.a>>>16)+(d.a>>>16)+(e.a>>>16)+(f>>>16),new c((65535&g)<<16|65535&f,h)}function F(a,b,d,e,f){var g,h,i;return g=(65535&a.b)+(65535&b.b)+(65535&d.b)+(65535&e.b)+(65535&f.b),h=(a.b>>>16)+(b.b>>>16)+(d.b>>>16)+(e.b>>>16)+(f.b>>>16)+(g>>>16),i=(65535&h)<<16|65535&g,g=(65535&a.a)+(65535&b.a)+(65535&d.a)+(65535&e.a)+(65535&f.a)+(h>>>16),h=(a.a>>>16)+(b.a>>>16)+(d.a>>>16)+(e.a>>>16)+(f.a>>>16)+(g>>>16),new c((65535&h)<<16|65535&g,i)}function G(a,b){var c,d,e,f,g,h,i,k,l,m=[],p=o,r=n,s=q,t=j,u=A,v=C,w=[1732584193,4023233417,2562383102,271733878,3285377520];for(a[b>>>5]|=128<<24-b%32,a[(b+65>>>9<<4)+15]=b,l=a.length,i=0;l>i;i+=16){for(c=w[0],d=w[1],e=w[2],f=w[3],g=w[4],k=0;80>k;k+=1)m[k]=16>k?a[k+i]:t(m[k-3]^m[k-8]^m[k-14]^m[k-16],1),h=20>k?v(t(c,5),p(d,e,f),g,1518500249,m[k]):40>k?v(t(c,5),r(d,e,f),g,1859775393,m[k]):60>k?v(t(c,5),s(d,e,f),g,2400959708,m[k]):v(t(c,5),r(d,e,f),g,3395469782,m[k]),g=f,f=e,e=t(d,30),d=c,c=h;w[0]=u(c,w[0]),w[1]=u(d,w[1]),w[2]=u(e,w[2]),w[3]=u(f,w[3]),w[4]=u(g,w[4])}return w}function H(a,b,d){var e,f,g,h,i,j,k,l,m,n,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=[],X=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(n=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],f=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],"SHA-224"===d||"SHA-256"===d)G=64,e=(b+65>>>9<<4)+15,J=16,K=1,U=Number,L=A,M=B,N=C,O=w,P=y,Q=s,R=u,T=q,S=o,n="SHA-224"===d?n:f;else{if("SHA-384"!==d&&"SHA-512"!==d)throw"Unexpected error in SHA-2 implementation";G=80,e=(b+128>>>10<<5)+31,J=32,K=2,U=c,L=D,M=E,N=F,O=x,P=z,Q=t,R=v,T=r,S=p,X=[new U(X[0],3609767458),new U(X[1],602891725),new U(X[2],3964484399),new U(X[3],2173295548),new U(X[4],4081628472),new U(X[5],3053834265),new U(X[6],2937671579),new U(X[7],3664609560),new U(X[8],2734883394),new U(X[9],1164996542),new U(X[10],1323610764),new U(X[11],3590304994),new U(X[12],4068182383),new U(X[13],991336113),new U(X[14],633803317),new U(X[15],3479774868),new U(X[16],2666613458),new U(X[17],944711139),new U(X[18],2341262773),new U(X[19],2007800933),new U(X[20],1495990901),new U(X[21],1856431235),new U(X[22],3175218132),new U(X[23],2198950837),new U(X[24],3999719339),new U(X[25],766784016),new U(X[26],2566594879),new U(X[27],3203337956),new U(X[28],1034457026),new U(X[29],2466948901),new U(X[30],3758326383),new U(X[31],168717936),new U(X[32],1188179964),new U(X[33],1546045734),new U(X[34],1522805485),new U(X[35],2643833823),new U(X[36],2343527390),new U(X[37],1014477480),new U(X[38],1206759142),new U(X[39],344077627),new U(X[40],1290863460),new U(X[41],3158454273),new U(X[42],3505952657),new U(X[43],106217008),new U(X[44],3606008344),new U(X[45],1432725776),new U(X[46],1467031594),new U(X[47],851169720),new U(X[48],3100823752),new U(X[49],1363258195),new U(X[50],3750685593),new U(X[51],3785050280),new U(X[52],3318307427),new U(X[53],3812723403),new U(X[54],2003034995),new U(X[55],3602036899),new U(X[56],1575990012),new U(X[57],1125592928),new U(X[58],2716904306),new U(X[59],442776044),new U(X[60],593698344),new U(X[61],3733110249),new U(X[62],2999351573),new U(X[63],3815920427),new U(3391569614,3928383900),new U(3515267271,566280711),new U(3940187606,3454069534),new U(4118630271,4000239992),new U(116418474,1914138554),new U(174292421,2731055270),new U(289380356,3203993006),new U(460393269,320620315),new U(685471733,587496836),new U(852142971,1086792851),new U(1017036298,365543100),new U(1126000580,2618297676),new U(1288033470,3409855158),new U(1501505948,4234509866),new U(1607167915,987167468),new U(1816402316,1246189591)],n="SHA-384"===d?[new U(3418070365,n[0]),new U(1654270250,n[1]),new U(2438529370,n[2]),new U(355462360,n[3]),new U(1731405415,n[4]),new U(41048885895,n[5]),new U(3675008525,n[6]),new U(1203062813,n[7])]:[new U(f[0],4089235720),new U(f[1],2227873595),new U(f[2],4271175723),new U(f[3],1595750129),new U(f[4],2917565137),new U(f[5],725511199),new U(f[6],4215389547),new U(f[7],327033209)]}for(a[b>>>5]|=128<<24-b%32,a[e]=b,V=a.length,H=0;V>H;H+=J){for(b=n[0],e=n[1],f=n[2],g=n[3],h=n[4],i=n[5],j=n[6],k=n[7],I=0;G>I;I+=1)W[I]=16>I?new U(a[I*K+H],a[I*K+H+1]):M(P(W[I-2]),W[I-7],O(W[I-15]),W[I-16]),l=N(k,R(h),S(h,i,j),X[I],W[I]),m=L(Q(b),T(b,e,f)),k=j,j=i,i=h,h=L(g,l),g=f,f=e,e=b,b=L(l,m);n[0]=L(b,n[0]),n[1]=L(e,n[1]),n[2]=L(f,n[2]),n[3]=L(g,n[3]),n[4]=L(h,n[4]),n[5]=L(i,n[5]),n[6]=L(j,n[6]),n[7]=L(k,n[7])}if("SHA-224"===d)a=[n[0],n[1],n[2],n[3],n[4],n[5],n[6]];else if("SHA-256"===d)a=n;else if("SHA-384"===d)a=[n[0].a,n[0].b,n[1].a,n[1].b,n[2].a,n[2].b,n[3].a,n[3].b,n[4].a,n[4].b,n[5].a,n[5].b];else{if("SHA-512"!==d)throw"Unexpected error in SHA-2 implementation";a=[n[0].a,n[0].b,n[1].a,n[1].b,n[2].a,n[2].b,n[3].a,n[3].b,n[4].a,n[4].b,n[5].a,n[5].b,n[6].a,n[6].b,n[7].a,n[7].b]}return a}"function"==typeof define?define(function(){return b}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=b:exports=b:a.jsSHA=b}(this);